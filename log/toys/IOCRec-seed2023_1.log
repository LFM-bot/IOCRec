2024-07-23 15:17:34 INFO     log save at : log\toys\IOCRec-seed2023_1.log
2024-07-23 15:17:34 INFO     model save at: save\IOCRec-toys-seed2023-2024-07-23_15-17-34.pth
2024-07-23 15:17:35 INFO     [1] Model Hyper-Parameter ---------------------
2024-07-23 15:17:35 INFO     model: IOCRec
2024-07-23 15:17:35 INFO     model_type: SEQUENTIAL
2024-07-23 15:17:35 INFO     aug_types: ['crop', 'mask', 'reorder']
2024-07-23 15:17:35 INFO     crop_ratio: 0.2
2024-07-23 15:17:35 INFO     mask_ratio: 0.7
2024-07-23 15:17:35 INFO     reorder_ratio: 0.2
2024-07-23 15:17:35 INFO     all_hidden: True
2024-07-23 15:17:35 INFO     tao: 1.0
2024-07-23 15:17:35 INFO     lamda: 0.1
2024-07-23 15:17:35 INFO     k_intention: 4
2024-07-23 15:17:35 INFO     embed_size: 64
2024-07-23 15:17:35 INFO     ffn_hidden: 512
2024-07-23 15:17:35 INFO     num_blocks: 3
2024-07-23 15:17:35 INFO     num_heads: 2
2024-07-23 15:17:35 INFO     hidden_dropout: 0.5
2024-07-23 15:17:35 INFO     attn_dropout: 0.5
2024-07-23 15:17:35 INFO     layer_norm_eps: 1e-12
2024-07-23 15:17:35 INFO     initializer_range: 0.02
2024-07-23 15:17:35 INFO     loss_type: CE
2024-07-23 15:17:35 INFO     [2] Experiment Hyper-Parameter ----------------
2024-07-23 15:17:35 INFO     [2-1] data hyper-parameter --------------------
2024-07-23 15:17:35 INFO     dataset: toys
2024-07-23 15:17:35 INFO     data_aug: True
2024-07-23 15:17:35 INFO     seq_filter_len: 0
2024-07-23 15:17:35 INFO     if_filter_target: False
2024-07-23 15:17:35 INFO     max_len: 50
2024-07-23 15:17:35 INFO     [2-2] pretraining hyper-parameter -------------
2024-07-23 15:17:35 INFO     do_pretraining: False
2024-07-23 15:17:35 INFO     pretraining_task: MISP
2024-07-23 15:17:35 INFO     pretraining_epoch: 10
2024-07-23 15:17:35 INFO     pretraining_batch: 512
2024-07-23 15:17:35 INFO     pretraining_lr: 0.001
2024-07-23 15:17:35 INFO     pretraining_l2: 0.0
2024-07-23 15:17:35 INFO     [2-3] training hyper-parameter ----------------
2024-07-23 15:17:35 INFO     epoch_num: 150
2024-07-23 15:17:35 INFO     train_batch: 256
2024-07-23 15:17:35 INFO     learning_rate: 0.001
2024-07-23 15:17:35 INFO     l2: 0
2024-07-23 15:17:35 INFO     patience: 10
2024-07-23 15:17:35 INFO     device: cuda:0
2024-07-23 15:17:35 INFO     num_worker: 0
2024-07-23 15:17:35 INFO     seed: 2023
2024-07-23 15:17:35 INFO     [2-4] evaluation hyper-parameter --------------
2024-07-23 15:17:35 INFO     split_type: valid_and_test
2024-07-23 15:17:35 INFO     split_mode: LS
2024-07-23 15:17:35 INFO     eval_mode: uni100
2024-07-23 15:17:35 INFO     metric: ['hit', 'ndcg']
2024-07-23 15:17:35 INFO     k: [5, 10, 20, 50]
2024-07-23 15:17:35 INFO     valid_metric: hit@10
2024-07-23 15:17:35 INFO     eval_batch: 256
2024-07-23 15:17:35 INFO     [2-5] save hyper-parameter --------------------
2024-07-23 15:17:35 INFO     log_save: log
2024-07-23 15:17:35 INFO     save: save
2024-07-23 15:17:35 INFO     model_saved: None
2024-07-23 15:17:35 INFO     [3] Data Statistic ----------------------------
2024-07-23 15:17:35 INFO     dataset: toys
2024-07-23 15:17:35 INFO     user number: 19412
2024-07-23 15:17:35 INFO     item number: 11925
2024-07-23 15:17:35 INFO     average seq length: 8.6337
2024-07-23 15:17:35 INFO     density: 0.0007 sparsity: 0.9993
2024-07-23 15:17:35 INFO     data after augmentation:
2024-07-23 15:17:35 INFO     train samples: 109361	eval samples: 19412	test samples: 19412
2024-07-23 15:17:35 INFO     [1] Model Architecture ------------------------
2024-07-23 15:17:35 INFO     total parameters: 1035520
2024-07-23 15:17:35 INFO     IOCRec(
  (cross_entropy): CrossEntropyLoss()
  (item_embedding): Embedding(11927, 64, padding_idx=0)
  (position_embedding): Embedding(50, 64)
  (input_layer_norm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
  (input_dropout): Dropout(p=0.5, inplace=False)
  (local_encoder): Transformer(
    (encoder_layers): ModuleList(
      (0-2): 3 x EncoderLayer(
        (attn_layer_norm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
        (pff_layer_norm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
        (self_attention): MultiHeadAttentionLayer(
          (fc_q): Linear(in_features=64, out_features=64, bias=True)
          (fc_k): Linear(in_features=64, out_features=64, bias=True)
          (fc_v): Linear(in_features=64, out_features=64, bias=True)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (fc_o): Linear(in_features=64, out_features=64, bias=True)
        )
        (pff): PointWiseFeedForwardLayer(
          (fc1): Linear(in_features=64, out_features=512, bias=True)
          (fc2): Linear(in_features=512, out_features=64, bias=True)
        )
        (hidden_dropout): Dropout(p=0.5, inplace=False)
        (pff_out_drop): Dropout(p=0.5, inplace=False)
      )
    )
  )
  (global_seq_encoder): GlobalSeqEncoder(
    (dropout): Dropout(p=0.5, inplace=False)
    (K_linear): Linear(in_features=64, out_features=64, bias=True)
    (V_linear): Linear(in_features=64, out_features=64, bias=True)
  )
  (disentangle_encoder): DisentangleEncoder(
    (pos_fai): Embedding(50, 64)
    (W): Linear(in_features=64, out_features=64, bias=True)
    (layer_norm_1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
    (layer_norm_2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
    (layer_norm_3): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
    (layer_norm_4): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
    (layer_norm_5): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  )
  (nce_loss): InfoNCELoss(
    (criterion): CrossEntropyLoss()
  )
)
2024-07-23 15:17:35 INFO     Start training...
2024-07-23 15:18:09 INFO     ----------------------------------------------------Epoch 1----------------------------------------------------
2024-07-23 15:18:09 INFO      Training Time :[33.3 s]	Training Loss = 11.0718
2024-07-23 15:18:10 INFO     Evaluation Time:[1.0 s]	  Eval Loss   = 9.3946
2024-07-23 15:18:10 INFO     hit@5:0.0718	hit@10:0.1202	hit@20:0.2062	hit@50:0.3898	ndcg@5:0.0443	ndcg@10:0.0598	ndcg@20:0.0813	ndcg@50:0.1180	
2024-07-23 15:18:42 INFO     ----------------------------------------------------Epoch 2----------------------------------------------------
2024-07-23 15:18:42 INFO      Training Time :[32.8 s]	Training Loss = 9.9107
2024-07-23 15:18:43 INFO     Evaluation Time:[0.9 s]	  Eval Loss   = 9.3376
2024-07-23 15:18:43 INFO     hit@5:0.1525	hit@10:0.2575	hit@20:0.4075	hit@50:0.4748	ndcg@5:0.0966	ndcg@10:0.1302	ndcg@20:0.1681	ndcg@50:0.1825	
2024-07-23 15:19:16 INFO     ----------------------------------------------------Epoch 3----------------------------------------------------
2024-07-23 15:19:16 INFO      Training Time :[32.8 s]	Training Loss = 9.5619
2024-07-23 15:19:17 INFO     Evaluation Time:[0.9 s]	  Eval Loss   = 9.1699
2024-07-23 15:19:17 INFO     hit@5:0.2255	hit@10:0.3208	hit@20:0.4547	hit@50:0.5217	ndcg@5:0.1567	ndcg@10:0.1874	ndcg@20:0.2211	ndcg@50:0.2354	
2024-07-23 15:19:50 INFO     ----------------------------------------------------Epoch 4----------------------------------------------------
2024-07-23 15:19:50 INFO      Training Time :[32.8 s]	Training Loss = 9.2151
2024-07-23 15:19:51 INFO     Evaluation Time:[0.9 s]	  Eval Loss   = 9.0117
2024-07-23 15:19:51 INFO     hit@5:0.2879	hit@10:0.3840	hit@20:0.5012	hit@50:0.5750	ndcg@5:0.2079	ndcg@10:0.2389	ndcg@20:0.2683	ndcg@50:0.2839	
2024-07-23 15:20:24 INFO     ----------------------------------------------------Epoch 5----------------------------------------------------
2024-07-23 15:20:24 INFO      Training Time :[32.9 s]	Training Loss = 8.9182
2024-07-23 15:20:25 INFO     Evaluation Time:[1.0 s]	  Eval Loss   = 8.8102
2024-07-23 15:20:25 INFO     hit@5:0.3426	hit@10:0.4392	hit@20:0.5495	hit@50:0.6274	ndcg@5:0.2529	ndcg@10:0.2841	ndcg@20:0.3119	ndcg@50:0.3282	
2024-07-23 15:20:58 INFO     ----------------------------------------------------Epoch 6----------------------------------------------------
2024-07-23 15:20:58 INFO      Training Time :[33.1 s]	Training Loss = 8.6244
2024-07-23 15:20:59 INFO     Evaluation Time:[0.9 s]	  Eval Loss   = 8.581
2024-07-23 15:20:59 INFO     hit@5:0.3856	hit@10:0.4870	hit@20:0.5982	hit@50:0.6972	ndcg@5:0.2900	ndcg@10:0.3227	ndcg@20:0.3508	ndcg@50:0.3712	
2024-07-23 15:21:32 INFO     ----------------------------------------------------Epoch 7----------------------------------------------------
2024-07-23 15:21:32 INFO      Training Time :[33.1 s]	Training Loss = 8.3363
2024-07-23 15:21:33 INFO     Evaluation Time:[0.9 s]	  Eval Loss   = 8.4352
2024-07-23 15:21:33 INFO     hit@5:0.4089	hit@10:0.5100	hit@20:0.6219	hit@50:0.7328	ndcg@5:0.3132	ndcg@10:0.3459	ndcg@20:0.3741	ndcg@50:0.3968	
2024-07-23 15:22:06 INFO     ----------------------------------------------------Epoch 8----------------------------------------------------
2024-07-23 15:22:06 INFO      Training Time :[32.9 s]	Training Loss = 8.0958
2024-07-23 15:22:07 INFO     Evaluation Time:[0.9 s]	  Eval Loss   = 8.3217
2024-07-23 15:22:07 INFO     hit@5:0.4293	hit@10:0.5254	hit@20:0.6391	hit@50:0.7704	ndcg@5:0.3325	ndcg@10:0.3635	ndcg@20:0.3922	ndcg@50:0.4189	
2024-07-23 15:22:40 INFO     ----------------------------------------------------Epoch 9----------------------------------------------------
2024-07-23 15:22:40 INFO      Training Time :[33.0 s]	Training Loss = 7.8828
2024-07-23 15:22:41 INFO     Evaluation Time:[0.9 s]	  Eval Loss   = 8.3024
2024-07-23 15:22:41 INFO     hit@5:0.4324	hit@10:0.5290	hit@20:0.6475	hit@50:0.7881	ndcg@5:0.3393	ndcg@10:0.3705	ndcg@20:0.4003	ndcg@50:0.4288	
2024-07-23 15:23:13 INFO     ----------------------------------------------------Epoch 10----------------------------------------------------
2024-07-23 15:23:13 INFO      Training Time :[32.9 s]	Training Loss = 7.6411
2024-07-23 15:23:14 INFO     Evaluation Time:[0.9 s]	  Eval Loss   = 8.3549
2024-07-23 15:23:14 INFO     hit@5:0.4394	hit@10:0.5328	hit@20:0.6481	hit@50:0.8010	ndcg@5:0.3455	ndcg@10:0.3756	ndcg@20:0.4047	ndcg@50:0.4356	
2024-07-23 15:23:47 INFO     ----------------------------------------------------Epoch 11----------------------------------------------------
2024-07-23 15:23:47 INFO      Training Time :[32.8 s]	Training Loss = 7.4921
2024-07-23 15:23:48 INFO     Evaluation Time:[0.9 s]	  Eval Loss   = 8.4414
2024-07-23 15:23:48 INFO     hit@5:0.4396	hit@10:0.5349	hit@20:0.6530	hit@50:0.8046	ndcg@5:0.3475	ndcg@10:0.3783	ndcg@20:0.4081	ndcg@50:0.4386	
2024-07-23 15:24:21 INFO     ----------------------------------------------------Epoch 12----------------------------------------------------
2024-07-23 15:24:21 INFO      Training Time :[32.9 s]	Training Loss = 7.3233
2024-07-23 15:24:22 INFO     Evaluation Time:[0.9 s]	  Eval Loss   = 8.4664
2024-07-23 15:24:22 INFO     hit@5:0.4418	hit@10:0.5354	hit@20:0.6513	hit@50:0.7995	ndcg@5:0.3486	ndcg@10:0.3788	ndcg@20:0.4079	ndcg@50:0.4379	
2024-07-23 15:24:55 INFO     ----------------------------------------------------Epoch 13----------------------------------------------------
2024-07-23 15:24:55 INFO      Training Time :[32.9 s]	Training Loss = 7.2029
2024-07-23 15:24:56 INFO     Evaluation Time:[0.9 s]	  Eval Loss   = 8.5498
2024-07-23 15:24:56 INFO     hit@5:0.4423	hit@10:0.5357	hit@20:0.6529	hit@50:0.8065	ndcg@5:0.3504	ndcg@10:0.3806	ndcg@20:0.4102	ndcg@50:0.4412	
2024-07-23 15:25:29 INFO     ----------------------------------------------------Epoch 14----------------------------------------------------
2024-07-23 15:25:29 INFO      Training Time :[32.9 s]	Training Loss = 7.0766
2024-07-23 15:25:30 INFO     Evaluation Time:[0.9 s]	  Eval Loss   = 8.6568
2024-07-23 15:25:30 INFO     hit@5:0.4435	hit@10:0.5385	hit@20:0.6561	hit@50:0.8055	ndcg@5:0.3522	ndcg@10:0.3829	ndcg@20:0.4125	ndcg@50:0.4427	
2024-07-23 15:26:03 INFO     ----------------------------------------------------Epoch 15----------------------------------------------------
2024-07-23 15:26:03 INFO      Training Time :[32.9 s]	Training Loss = 6.9914
2024-07-23 15:26:04 INFO     Evaluation Time:[0.9 s]	  Eval Loss   = 8.8304
2024-07-23 15:26:04 INFO     hit@5:0.4402	hit@10:0.5366	hit@20:0.6507	hit@50:0.8021	ndcg@5:0.3506	ndcg@10:0.3818	ndcg@20:0.4106	ndcg@50:0.4412	
2024-07-23 15:26:04 INFO     EarlyStopping Counter: 1 out of 10
2024-07-23 15:26:36 INFO     ----------------------------------------------------Epoch 16----------------------------------------------------
2024-07-23 15:26:36 INFO      Training Time :[32.9 s]	Training Loss = 6.9066
2024-07-23 15:26:37 INFO     Evaluation Time:[0.9 s]	  Eval Loss   = 8.8853
2024-07-23 15:26:37 INFO     hit@5:0.4405	hit@10:0.5362	hit@20:0.6516	hit@50:0.8025	ndcg@5:0.3508	ndcg@10:0.3817	ndcg@20:0.4108	ndcg@50:0.4413	
2024-07-23 15:26:37 INFO     EarlyStopping Counter: 2 out of 10
2024-07-23 15:27:10 INFO     ----------------------------------------------------Epoch 17----------------------------------------------------
2024-07-23 15:27:10 INFO      Training Time :[32.9 s]	Training Loss = 6.8368
2024-07-23 15:27:11 INFO     Evaluation Time:[0.9 s]	  Eval Loss   = 8.9803
2024-07-23 15:27:11 INFO     hit@5:0.4457	hit@10:0.5386	hit@20:0.6551	hit@50:0.8060	ndcg@5:0.3545	ndcg@10:0.3846	ndcg@20:0.4139	ndcg@50:0.4444	
2024-07-23 15:27:44 INFO     ----------------------------------------------------Epoch 18----------------------------------------------------
2024-07-23 15:27:44 INFO      Training Time :[32.8 s]	Training Loss = 6.7691
2024-07-23 15:27:45 INFO     Evaluation Time:[0.9 s]	  Eval Loss   = 9.0
2024-07-23 15:27:45 INFO     hit@5:0.4424	hit@10:0.5354	hit@20:0.6513	hit@50:0.8080	ndcg@5:0.3506	ndcg@10:0.3806	ndcg@20:0.4098	ndcg@50:0.4414	
2024-07-23 15:27:45 INFO     EarlyStopping Counter: 1 out of 10
2024-07-23 15:28:18 INFO     ----------------------------------------------------Epoch 19----------------------------------------------------
2024-07-23 15:28:18 INFO      Training Time :[32.9 s]	Training Loss = 6.7210
2024-07-23 15:28:19 INFO     Evaluation Time:[0.9 s]	  Eval Loss   = 9.1515
2024-07-23 15:28:19 INFO     hit@5:0.4448	hit@10:0.5383	hit@20:0.6550	hit@50:0.8110	ndcg@5:0.3541	ndcg@10:0.3843	ndcg@20:0.4137	ndcg@50:0.4453	
2024-07-23 15:28:19 INFO     EarlyStopping Counter: 2 out of 10
2024-07-23 15:28:52 INFO     ----------------------------------------------------Epoch 20----------------------------------------------------
2024-07-23 15:28:52 INFO      Training Time :[32.9 s]	Training Loss = 6.6472
2024-07-23 15:28:52 INFO     Evaluation Time:[0.9 s]	  Eval Loss   = 9.3712
2024-07-23 15:28:52 INFO     hit@5:0.4424	hit@10:0.5359	hit@20:0.6491	hit@50:0.8114	ndcg@5:0.3503	ndcg@10:0.3805	ndcg@20:0.4090	ndcg@50:0.4418	
2024-07-23 15:28:52 INFO     EarlyStopping Counter: 3 out of 10
2024-07-23 15:29:25 INFO     ----------------------------------------------------Epoch 21----------------------------------------------------
2024-07-23 15:29:25 INFO      Training Time :[32.8 s]	Training Loss = 6.6233
2024-07-23 15:29:26 INFO     Evaluation Time:[1.0 s]	  Eval Loss   = 9.2789
2024-07-23 15:29:26 INFO     hit@5:0.4415	hit@10:0.5368	hit@20:0.6493	hit@50:0.8083	ndcg@5:0.3498	ndcg@10:0.3806	ndcg@20:0.4089	ndcg@50:0.4411	
2024-07-23 15:29:26 INFO     EarlyStopping Counter: 4 out of 10
2024-07-23 15:29:59 INFO     ----------------------------------------------------Epoch 22----------------------------------------------------
2024-07-23 15:29:59 INFO      Training Time :[32.9 s]	Training Loss = 6.5730
2024-07-23 15:30:00 INFO     Evaluation Time:[0.9 s]	  Eval Loss   = 9.4025
2024-07-23 15:30:00 INFO     hit@5:0.4408	hit@10:0.5347	hit@20:0.6493	hit@50:0.8103	ndcg@5:0.3508	ndcg@10:0.3810	ndcg@20:0.4099	ndcg@50:0.4424	
2024-07-23 15:30:00 INFO     EarlyStopping Counter: 5 out of 10
2024-07-23 15:30:33 INFO     ----------------------------------------------------Epoch 23----------------------------------------------------
2024-07-23 15:30:33 INFO      Training Time :[33.0 s]	Training Loss = 6.5330
2024-07-23 15:30:34 INFO     Evaluation Time:[0.9 s]	  Eval Loss   = 9.5505
2024-07-23 15:30:34 INFO     hit@5:0.4380	hit@10:0.5326	hit@20:0.6483	hit@50:0.8110	ndcg@5:0.3489	ndcg@10:0.3794	ndcg@20:0.4085	ndcg@50:0.4413	
2024-07-23 15:30:34 INFO     EarlyStopping Counter: 6 out of 10
2024-07-23 15:31:07 INFO     ----------------------------------------------------Epoch 24----------------------------------------------------
2024-07-23 15:31:07 INFO      Training Time :[32.9 s]	Training Loss = 6.4867
2024-07-23 15:31:08 INFO     Evaluation Time:[0.9 s]	  Eval Loss   = 9.2692
2024-07-23 15:31:08 INFO     hit@5:0.4389	hit@10:0.5329	hit@20:0.6490	hit@50:0.8044	ndcg@5:0.3481	ndcg@10:0.3784	ndcg@20:0.4076	ndcg@50:0.4391	
2024-07-23 15:31:08 INFO     EarlyStopping Counter: 7 out of 10
2024-07-23 15:31:41 INFO     ----------------------------------------------------Epoch 25----------------------------------------------------
2024-07-23 15:31:41 INFO      Training Time :[32.8 s]	Training Loss = 6.4528
2024-07-23 15:31:42 INFO     Evaluation Time:[1.0 s]	  Eval Loss   = 9.3407
2024-07-23 15:31:42 INFO     hit@5:0.4401	hit@10:0.5327	hit@20:0.6511	hit@50:0.8073	ndcg@5:0.3492	ndcg@10:0.3790	ndcg@20:0.4088	ndcg@50:0.4404	
2024-07-23 15:31:42 INFO     EarlyStopping Counter: 8 out of 10
2024-07-23 15:32:14 INFO     ----------------------------------------------------Epoch 26----------------------------------------------------
2024-07-23 15:32:14 INFO      Training Time :[32.8 s]	Training Loss = 6.4163
2024-07-23 15:32:15 INFO     Evaluation Time:[0.9 s]	  Eval Loss   = 9.3725
2024-07-23 15:32:15 INFO     hit@5:0.4367	hit@10:0.5293	hit@20:0.6491	hit@50:0.8035	ndcg@5:0.3471	ndcg@10:0.3771	ndcg@20:0.4071	ndcg@50:0.4384	
2024-07-23 15:32:15 INFO     EarlyStopping Counter: 9 out of 10
2024-07-23 15:32:48 INFO     ----------------------------------------------------Epoch 27----------------------------------------------------
2024-07-23 15:32:48 INFO      Training Time :[32.9 s]	Training Loss = 6.3712
2024-07-23 15:32:49 INFO     Evaluation Time:[1.0 s]	  Eval Loss   = 9.3215
2024-07-23 15:32:49 INFO     hit@5:0.4349	hit@10:0.5317	hit@20:0.6480	hit@50:0.8015	ndcg@5:0.3455	ndcg@10:0.3767	ndcg@20:0.4059	ndcg@50:0.4370	
2024-07-23 15:32:49 INFO     EarlyStopping Counter: 10 out of 10
2024-07-23 15:32:49 INFO     ------------------------------------------------Best Evaluation------------------------------------------------
2024-07-23 15:32:49 INFO     Best Result at Epoch: 17	 Early Stop at Patience: 10
2024-07-23 15:32:49 INFO     hit@5:0.4457	hit@10:0.5386	hit@20:0.6551	hit@50:0.8060	ndcg@5:0.3545	ndcg@10:0.3846	ndcg@20:0.4139	ndcg@50:0.4444	
2024-07-23 15:32:50 INFO     -----------------------------------------------------Test Results------------------------------------------------------
2024-07-23 15:32:50 INFO     hit@5:0.4030	hit@10:0.4966	hit@20:0.6120	hit@50:0.7719	ndcg@5:0.3163	ndcg@10:0.3464	ndcg@20:0.3755	ndcg@50:0.4080	
